---
# Alpha â€“ Anny Hua
# Feature: Windows wallpaper theming 

- name: Create wallpaper directory
  ansible.windows.win_file:
    path: C:\ProgramData\Inscope\Branding
    state: directory

- name: Copy wallpaper to host
  ansible.windows.win_copy:
    src: "{{ wallpaper_src }}"
    dest: "C:\\ProgramData\\Inscope\\Branding\\wallpaper.jpg"

- name: Copy wallpaper script to host
  ansible.windows.win_copy:
    src: "wallpaper_script.ps1"
    dest: "C:\\ProgramData\\Inscope\\"

- name: Register Wallpaper Script to run at logon
  ansible.windows.win_regedit:
    path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Run
    name: "wallpaperChange"
    data: 'powershell.exe -NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\ProgramData\Inscope\wallpaper_script.ps1"'
    type: string