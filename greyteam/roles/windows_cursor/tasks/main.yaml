---
# Alpha â€“ Anny Hua
# Feature: Custom cursor theme (ship cursor files)
# Targets: Windows 10 clients

- name: Create cursor directory
  ansible.windows.win_file:
    path: C:\ProgramData\Inscope\Cursors
    state: directory

- name: Copy cursor files to host
  ansible.windows.win_copy:
    src: "cursors/"
    dest: "C:\\ProgramData\\Inscope\\Cursors\\"

- name: Set cursor registry paths to custom cursors
  ansible.windows.win_regedit:
    path: HKCU:\Control Panel\Cursors
    name: "{{ item.name }}"
    data: "{{ item.data }}"
    type: string
  loop:
    - { name: "Arrow",       data: "C:\\ProgramData\\Inscope\\Cursors\\Arrow.cur" }
    - { name: "IBeam",       data: "C:\\ProgramData\\Inscope\\Cursors\\IBeam.cur" }
    - { name: "Select",        data: "C:\\ProgramData\\Inscope\\Cursors\\Select.ani" }

- name: Notify user a logoff/login may be needed to fully apply cursor changes
  ansible.windows.win_shell: |
    Write-Output "Custom cursor files deployed. Logoff/login may be required to refresh."
  changed_when: false